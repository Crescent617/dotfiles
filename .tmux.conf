# --------------------------------------------------- Tmux Config -----------------------------------------------------------
# set-option -g default-shell /bin/bash
set-option -g mouse on

set -g history-limit 20000
set -g base-index 1      # 设置窗口的起始下标为1
set -g pane-base-index 1 # 设置面板的起始下标为1
set -s focus-events on

set-option -g set-titles on
set-window-option -g automatic-rename on
bind -n 'C-\' command-prompt

# # --------------------------------------------------- prefix -----------------------------------------------------------
# # 修改指令前缀
set -g prefix C-a
bind C-a send-prefix # 绑定 Ctrl+a 为新的指令前缀

# 从tmux v1.6版起，支持设置第二个指令前缀
# set-option -g prefix2 ` # 设置一个不常用的`键作为指令前缀，按键更快些

# # --------------------------------------------------- 面板 -----------------------------------------------------------
unbind '"'
bind - splitw -v -c '#{pane_current_path}' # 垂直方向新增面板，默认进入当前目录
unbind %
bind = splitw -h -c '#{pane_current_path}' # 水平方向新增面板，默认进入当前目录

# pane border
# set-option -g pane-border-style fg=colour235 #fg=base02
# set-option -g pane-active-border-style fg=colour240 #fg=base01

# Edit configuration and reload
bind C-e new-window -n 'tmux.conf' "sh -c '\${EDITOR:-vim} ~/.tmux.conf && tmux source ~/.tmux.conf && tmux display \"Config reloaded\"'"

# new window and retain cwd
# bind-key C command-prompt -p "Name of new window: " "new-window -n '%%'"

# Prompt to rename window right after it's created
# set-hook -g after-new-window 'command-prompt -I "#{window_name}" "rename-window '%%'"'

# # --------------------------------------------------- vim 风格 -----------------------------------------------------------

set -g status-keys vi
set-window-option -g mode-keys vi
set-window-option -g mode-style "fg=default,bg=#43437C"

bind -T copy-mode-vi v send -X begin-selection

# --------------------------------------------------- Message -----------------------------------------------------------
set-option -ag message-style fg=green,blink 
set-option -ag message-style bg=black

# --------------------------------------------------- 状态栏 -----------------------------------------------------------
#+--------+
#+ Status +
#+--------+
set-option -g status-justify left
set-option -g status-style fg=green,bg=black
set-option -g status-position bottom
set-option -g status-right-length 60
set-option -g status-left-length 40

#+--- Bars ---+
set -g status-left "#[fg=blue,bg=black]#[fg=black,bg=blue,bold][#S]#[fg=blue,bg=black]#[bg=black] "
set -g status-right '#[fg=brightgreen]#[fg=black,bg=brightgreen]#{=21:pane_title} #[fg=black,bg=yellow] %Y-%m-%d %H:%M #{tmux_mode_indicator}'

#+--- Windows ---+
set -g window-status-format "#[fg=brightblack,bg=black]#[fg=white,bg=brightblack] #I |#[fg=white,bg=brightblack] #W #F #[fg=brightblack,bg=black]"
set -g window-status-current-format "#[bg=black,fg=cyan]#[fg=black,bg=cyan] #I |#[fg=black,bg=cyan] #W #F #[fg=cyan,bg=black]"
set -g window-status-separator " "

# # --------------------------------------------------- plugins ----------------------------------------------------
# 将下面内容复制到`~/.tmux.conf`
# List of plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'MunifTanjim/tmux-mode-indicator'
set -g @plugin 'tmux-plugins/tmux-pain-control'
set -g @plugin 'tmux-plugins/tmux-urlview'

set -g @plugin 'fcsonline/tmux-thumbs'
set -g @thumbs-command 'echo -n {} | pbcopy'
set -g @thumbs-hint-bg-color yellow
set -g @thumbs-hint-fg-color black

# Other examples:
# set -g @plugin 'tmux-plugins/tmux-sidebar'
# set -g @plugin 'sainnhe/tmux-fzf'

# set -g @plugin 'tmux-plugins/tmux-copycat'
# set -g @plugin 'github_username/plugin_name'
# set -g @plugin 'git@github.com/user/plugin'
# set -g @plugin 'git@bitbucket.com/user/plugin'

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'

# ---------------------------------- overwrite plugin -------------------------------------
bind -T copy-mode-vi MouseDragEnd1Pane send -X copy-selection
bind -T copy-mode-vi y send -X copy-selection
bind -T copy-mode MouseDragEnd1Pane send -X copy-selection

# Undercurl
set -g default-terminal "${TERM}"
set -as terminal-overrides ',*:Smulx=\E[4::%p1%dm'  # undercurl support
set -as terminal-overrides ',*:Setulc=\E[58::2::%p1%{65536}%/%d::%p1%{256}%/%{255}%&%d::%p1%{255}%&%d%;m'  # underscore colours - needs tmux-3.0
